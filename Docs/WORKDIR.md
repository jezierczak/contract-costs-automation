# Work Directory Structure (work_dir)

This document describes the directory layout used by **contract_costs_automation**.
The `work_dir` is the runtime workspace for CLI operations, Excel imports/exports,
watchers, and logs.

---

## Root Structure

```
work_dir/
├── inputs/
├── owners/
├── reports/
├── exports/
├── logs/
```

---

## inputs/

Main entry point for **manual Excel-based workflows** (`showexcel`, `applyexcel`).

```
inputs/
├── contracts/
│   ├── new/
│   ├── edit/
│   └── processed/
│       └── YYYY-MM-DD_HHMMSS/
│
├── companies/
│   ├── new/
│   ├── edit/
│   └── processed/
│       └── YYYY-MM-DD_HHMMSS/
│
├── invoices/
│   ├── new/
│   ├── in_progress/
│   ├── edit/
│   └── processed/
│       └── YYYY-MM-DD_HHMMSS/
```

### contracts/
- **new/**  
  Excel files generated by `showexcel contract` (new contract).
- **edit/**  
  Excel files generated by `showexcel contract <CODE|UUID>`.
- **processed/**  
  Automatically moved here after successful `applyexcel`.
  Files are grouped by timestamp.

### companies/
- Used by `showexcel company` and `applyexcel company`.
- Same lifecycle as contracts.

### invoices/
- Used for invoice metadata + invoice lines assignment.
- Supports NEW / IN_PROGRESS workflows.
- Processed files are archived by timestamp.

---

## owners/

```
owners/
└── YYYY/
    └── MM/
        └── DD/
```

- Used by **watchers**
- Raw scanned invoices (PDF, images)
- Organized by scan date
- These files are NOT modified by applyexcel

---

## reports/

```
reports/
├── cost_progress/
├── summaries/
└── analytics/
```

- Generated read-only reports
- Snapshots, summaries, KPIs
- Never used as input

---

## exports/

```
exports/
├── excel/
├── csv/
└── pdf/
```

- Programmatic exports
- Reporting outputs
- Safe for sharing

---

## logs/

```
logs/
├── app.log
├── watcher.log
└── errors.log
```

- Runtime logs
- Watcher diagnostics
- Error tracing

---

## Processing Rules

- Excel files are **source of truth**
- After successful processing:
  - File is moved to `processed/{timestamp}/`
- Failed Excel:
  - NOT moved
  - Errors are reported in CLI output
  - User fixes Excel and re-runs

---

## Design Principles

- No overwriting user files
- Full audit trail via timestamps
- Separation of:
  - input
  - processing
  - output
- CLI and Watchers never collide

---

_Last updated: 2025-12-23_
